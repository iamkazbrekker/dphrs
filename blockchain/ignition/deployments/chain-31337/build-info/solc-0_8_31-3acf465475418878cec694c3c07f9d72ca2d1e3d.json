{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_31-3acf465475418878cec694c3c07f9d72ca2d1e3d",
  "solcVersion": "0.8.31",
  "solcLongVersion": "0.8.31+commit.fd3a2265",
  "userSourceNameMap": {
    "contracts/PatientRegistry.sol": "project/contracts/PatientRegistry.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "osaka",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": []
    },
    "sources": {
      "project/contracts/PatientRegistry.sol": {
        "content": "//SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.31;\r\n\r\ncontract PatientsRegistry {\r\n    struct MedicalRecord {\r\n        uint256 timestamp;\r\n        string recordType;\r\n        string description;\r\n        string doctorName;\r\n        string institution;\r\n    }\r\n\r\n    struct Patient{\r\n        bool registered;\r\n        uint256 dateOfBirth;\r\n        string name;\r\n        string bloodType;\r\n        string gender;\r\n        MedicalRecord[] records;\r\n    }\r\n\r\n    mapping (address => Patient) private patients;\r\n\r\n    event PatientRegistered(address indexed patient, string name, uint256 timestamp);\r\n    event RecordAdded(address indexed patient, string recordType, uint256 timestamp);\r\n\r\n    modifier registered(){\r\n        require(patients[msg.sender].registered, \"Not registered\");\r\n        _;\r\n    }\r\n    modifier notRegistered(){\r\n        require(!patients[msg.sender].registered, \"Already registered\");\r\n        _;\r\n    }\r\n\r\n    function register(\r\n    string calldata _name, \r\n    uint256 _dateOfBirth, \r\n    string calldata _bloodType, \r\n    string calldata _gender) external notRegistered{\r\n        require (bytes(_name).length > 0, \"Name is required\");\r\n        require(_dateOfBirth > 0, \"Date of birth is required\");\r\n        require(bytes(_gender).length>0,\"Gender is required\");\r\n\r\n        Patient storage p = patients[msg.sender];\r\n        p.registered = true;\r\n        p.name = _name;\r\n        p.dateOfBirth = _dateOfBirth;\r\n        p.bloodType = _bloodType;\r\n        p.gender = _gender;\r\n\r\n        emit PatientRegistered(msg.sender,_name, block.timestamp);\r\n    }\r\n\r\n    function addMedicalRecord(\r\n        string calldata _recordType,\r\n        string calldata _description,\r\n        string calldata _doctorName,\r\n        string calldata _institution\r\n    ) external registered{\r\n        require(bytes(_recordType).length > 0, \"Record type required\");\r\n        require(bytes(_description).length > 0, \"Description is required\");\r\n        require(bytes(_doctorName).length > 0, \"Doctor name is required\");\r\n        require(bytes(_institution).length > 0, \"Institution name is required\");\r\n\r\n        patients[msg.sender].records.push(MedicalRecord({\r\n            timestamp: block.timestamp,\r\n            recordType: _recordType,\r\n            description: _description,\r\n            doctorName: _doctorName,\r\n            institution: _institution\r\n        }));\r\n\r\n        emit RecordAdded(msg.sender, _recordType, block.timestamp);\r\n    }\r\n\r\n    function getMyProfile() external view registered returns(string memory name, uint256 dateOfBirth, string memory bloodType, string memory gender, uint256 recordCount){\r\n        Patient storage p = patients[msg.sender];\r\n        return (p.name, p.dateOfBirth, p.bloodType, p.gender, p.records.length);\r\n    }\r\n\r\n    function getMedicalRecord(uint256 index) external view registered returns(\r\n        uint256 timestamp,\r\n        string memory recordType,\r\n        string memory description,\r\n        string memory doctorName,\r\n        string memory institution\r\n    ){\r\n        Patient storage p = patients[msg.sender];\r\n        require(index < p.records.length, \"Index out of bounds\");\r\n        MedicalRecord storage r = p.records[index];\r\n        return (r.timestamp, r.recordType, r.description, r.doctorName, r.institution);\r\n    }\r\n\r\n    function getRecordCount() external view registered returns(uint256){\r\n        return patients[msg.sender].records.length;\r\n    }\r\n\r\n    function isRegistered() external view returns(bool){\r\n        return patients[msg.sender].registered;\r\n    }\r\n}"
      }
    }
  }
}